<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ML Research Dashboard - AI-Powered Discovery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -10px rgba(0,0,0,0.3);
        }
        .metric-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .loading { animation: pulse 1.5s ease-in-out infinite; }
        .tag-pill {
            transition: all 0.2s ease;
        }
        .tag-pill:hover {
            transform: scale(1.05);
        }
        .ai-badge {
            background: linear-gradient(90deg, #FFD700 0%, #FFA500 100%);
            color: #000;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-xl">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold">ML Research Dashboard</h1>
                    <p class="text-purple-100 mt-1">AI-Powered Research Discovery for Researchers</p>
                    <span class="inline-block mt-2 px-3 py-1 ai-badge rounded-full text-sm">
                        Better than Papers with Code
                    </span>
                </div>
                <div class="flex items-center gap-4">
                    <button onclick="openSettings()" class="p-2 hover:bg-white/20 rounded-lg transition">
                        <i data-lucide="settings" class="w-5 h-5"></i>
                    </button>
                    <button onclick="toggleDarkMode()" class="p-2 hover:bg-white/20 rounded-lg transition">
                        <i data-lucide="moon" class="w-5 h-5"></i>
                    </button>
                    <div class="flex items-center gap-2 bg-white/20 px-4 py-2 rounded-lg">
                        <i data-lucide="user" class="w-4 h-4"></i>
                        <span id="userName">Researcher</span>
                    </div>
                </div>
            </div>
            
            <!-- Feature Pills -->
            <div class="flex flex-wrap gap-3 mt-4">
                <div class="flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full">
                    <i data-lucide="sparkles" class="w-4 h-4"></i>
                    <span class="text-sm">AI Summaries</span>
                </div>
                <div class="flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full">
                    <i data-lucide="user-check" class="w-4 h-4"></i>
                    <span class="text-sm">Personalized Feed</span>
                </div>
                <div class="flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full">
                    <i data-lucide="trending-up" class="w-4 h-4"></i>
                    <span class="text-sm">Real Impact Metrics</span>
                </div>
                <div class="flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full">
                    <i data-lucide="git-branch" class="w-4 h-4"></i>
                    <span class="text-sm">Research Lineage</span>
                </div>
                <div class="flex items-center gap-2 bg-white/20 px-3 py-1 rounded-full">
                    <i data-lucide="bookmark" class="w-4 h-4"></i>
                    <span class="text-sm">Smart Bookmarks</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Search and Filters -->
        <div class="mb-8 bg-white rounded-xl shadow-lg p-6">
            <div class="flex flex-col lg:flex-row gap-4">
                <div class="flex-1">
                    <div class="relative">
                        <input 
                            type="text" 
                            id="searchInput"
                            placeholder="Search papers, authors, or ask a research question..." 
                            class="w-full px-4 py-3 pl-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"
                        >
                        <i data-lucide="search" class="absolute left-4 top-3.5 w-5 h-5 text-gray-400"></i>
                    </div>
                </div>
                <button 
                    onclick="searchWithAI()" 
                    class="px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition flex items-center gap-2"
                >
                    <i data-lucide="sparkles" class="w-4 h-4"></i>
                    AI Search
                </button>
                <button 
                    onclick="searchPapers()" 
                    class="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition"
                >
                    Classic Search
                </button>
            </div>
            
            <!-- Smart Filters -->
            <div class="mt-4 flex flex-wrap gap-3">
                <button onclick="setFilter('for-you')" class="px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition flex items-center gap-2">
                    <i data-lucide="star" class="w-4 h-4"></i>
                    For You
                </button>
                <button onclick="setFilter('trending')" class="px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition flex items-center gap-2">
                    <i data-lucide="trending-up" class="w-4 h-4"></i>
                    Trending
                </button>
                <button onclick="setFilter('high-impact')" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition flex items-center gap-2">
                    <i data-lucide="award" class="w-4 h-4"></i>
                    High Impact
                </button>
                <button onclick="setFilter('needs-review')" class="px-4 py-2 bg-orange-100 text-orange-700 rounded-lg hover:bg-orange-200 transition flex items-center gap-2">
                    <i data-lucide="message-circle" class="w-4 h-4"></i>
                    Needs Review
                </button>
                <button onclick="setFilter('breakthrough')" class="px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition flex items-center gap-2">
                    <i data-lucide="zap" class="w-4 h-4"></i>
                    Breakthroughs
                </button>
            </div>
            
            <!-- Interest Tags -->
            <div class="mt-4">
                <p class="text-sm text-gray-600 mb-2">Your interests:</p>
                <div class="flex flex-wrap gap-2" id="interestTags">
                    <!-- Interest tags will be populated here -->
                </div>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-lg shadow p-4 flex items-center justify-between">
                <div>
                    <p class="text-gray-500 text-sm">Papers Today</p>
                    <p class="text-2xl font-bold text-gray-900">47</p>
                </div>
                <i data-lucide="file-text" class="w-8 h-8 text-purple-500"></i>
            </div>
            <div class="bg-white rounded-lg shadow p-4 flex items-center justify-between">
                <div>
                    <p class="text-gray-500 text-sm">Trending Topics</p>
                    <p class="text-2xl font-bold text-gray-900">12</p>
                </div>
                <i data-lucide="trending-up" class="w-8 h-8 text-green-500"></i>
            </div>
            <div class="bg-white rounded-lg shadow p-4 flex items-center justify-between">
                <div>
                    <p class="text-gray-500 text-sm">Saved Papers</p>
                    <p class="text-2xl font-bold text-gray-900">234</p>
                </div>
                <i data-lucide="bookmark" class="w-8 h-8 text-blue-500"></i>
            </div>
            <div class="bg-white rounded-lg shadow p-4 flex items-center justify-between">
                <div>
                    <p class="text-gray-500 text-sm">Reading Queue</p>
                    <p class="text-2xl font-bold text-gray-900">8</p>
                </div>
                <i data-lucide="clock" class="w-8 h-8 text-orange-500"></i>
            </div>
        </div>

        <!-- Papers Container -->
        <div id="papersContainer" class="space-y-6">
            <!-- Papers will be loaded here -->
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="hidden flex justify-center items-center py-12">
            <div class="text-center">
                <div class="loading text-4xl mb-2">üî¨</div>
                <p class="text-gray-600">Analyzing papers with AI...</p>
            </div>
        </div>

        <!-- Load More -->
        <div id="loadMoreContainer" class="mt-8 text-center hidden">
            <button 
                onclick="loadMore()" 
                class="px-8 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition"
            >
                Load More Papers
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 max-w-md w-full mx-4">
            <h3 class="text-xl font-bold mb-4">Personalization Settings</h3>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                <input type="text" id="userNameInput" class="w-full px-3 py-2 border rounded-lg" placeholder="Enter your name">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Research Interests</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="transformers"> Transformers
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="computer-vision"> Computer Vision
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="nlp"> NLP
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="reinforcement-learning"> Reinforcement Learning
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" value="generative-models"> Generative Models
                    </label>
                </div>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">AI Features</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" id="aiSummaries" checked class="mr-2"> AI Summaries
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="impactPrediction" checked class="mr-2"> Impact Prediction
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="relatedPapers" checked class="mr-2"> Show Related Papers
                    </label>
                </div>
            </div>
            
            <div class="flex gap-3 justify-end">
                <button onclick="closeSettings()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300">
                    Cancel
                </button>
                <button onclick="saveSettings()" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                    Save Settings
                </button>
            </div>
        </div>
    </div>

    <script>
        // State Management
        let papers = [];
        let userProfile = JSON.parse(localStorage.getItem('userProfile') || '{}');
        let savedPapers = JSON.parse(localStorage.getItem('savedPapers') || '[]');
        let currentFilter = 'for-you';

        // Initialize Lucide icons
        lucide.createIcons();

        // User Profile Management
        function initializeUserProfile() {
            if (!userProfile.name) {
                userProfile = {
                    name: 'Researcher',
                    interests: ['transformers', 'nlp', 'computer-vision'],
                    preferences: {
                        aiSummaries: true,
                        impactPrediction: true,
                        relatedPapers: true
                    }
                };
                localStorage.setItem('userProfile', JSON.stringify(userProfile));
            }
            updateUIWithProfile();
        }

        function updateUIWithProfile() {
            document.getElementById('userName').textContent = userProfile.name || 'Researcher';
            renderInterestTags();
        }

        function renderInterestTags() {
            const container = document.getElementById('interestTags');
            const interests = userProfile.interests || [];
            container.innerHTML = interests.map(interest => `
                <span class="px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm tag-pill cursor-pointer" onclick="searchByInterest('${interest}')">
                    ${interest.replace('-', ' ')}
                </span>
            `).join('');
        }

        // Settings Modal
        function openSettings() {
            document.getElementById('settingsModal').classList.remove('hidden');
            document.getElementById('userNameInput').value = userProfile.name || '';
            
            // Set checkboxes
            const checkboxes = document.querySelectorAll('#settingsModal input[type="checkbox"]');
            checkboxes.forEach(cb => {
                if (cb.value && userProfile.interests?.includes(cb.value)) {
                    cb.checked = true;
                }
            });
            
            if (userProfile.preferences) {
                document.getElementById('aiSummaries').checked = userProfile.preferences.aiSummaries;
                document.getElementById('impactPrediction').checked = userProfile.preferences.impactPrediction;
                document.getElementById('relatedPapers').checked = userProfile.preferences.relatedPapers;
            }
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.add('hidden');
        }

        function saveSettings() {
            userProfile.name = document.getElementById('userNameInput').value || 'Researcher';
            
            // Get selected interests
            const interests = [];
            document.querySelectorAll('#settingsModal input[type="checkbox"][value]').forEach(cb => {
                if (cb.checked) interests.push(cb.value);
            });
            userProfile.interests = interests;
            
            // Get preferences
            userProfile.preferences = {
                aiSummaries: document.getElementById('aiSummaries').checked,
                impactPrediction: document.getElementById('impactPrediction').checked,
                relatedPapers: document.getElementById('relatedPapers').checked
            };
            
            localStorage.setItem('userProfile', JSON.stringify(userProfile));
            updateUIWithProfile();
            closeSettings();
            
            // Refresh papers based on new interests
            if (currentFilter === 'for-you') {
                loadPersonalizedPapers();
            }
        }

        // Paper Generation with AI Features
        function generateAISummary(title, abstract) {
            // Simulate AI summary generation
            const summaries = [
                "This paper introduces a novel approach that significantly improves performance over existing baselines.",
                "Key innovation: The authors propose a new architecture that scales better with increased data.",
                "Breakthrough research showing how this method outperforms state-of-the-art by 15% on standard benchmarks.",
                "Important findings on model efficiency, reducing training time by 3x while maintaining accuracy.",
                "This work bridges the gap between theory and practice, offering practical insights for real-world applications."
            ];
            return summaries[Math.floor(Math.random() * summaries.length)];
        }

        function generateWhyItMatters(title) {
            const reasons = [
                "Predicts model performance before expensive training",
                "Enables efficient resource allocation in ML workflows",
                "Opens new research directions in model optimization",
                "Could reduce computational costs by 40%",
                "Provides theoretical foundation for future work"
            ];
            return reasons[Math.floor(Math.random() * reasons.length)];
        }

        function generateImpactMetrics() {
            return {
                citations: Math.floor(Math.random() * 1000),
                github: Math.floor(Math.random() * 500),
                blogs: Math.floor(Math.random() * 100),
                inUse: Math.floor(Math.random() * 50),
                trendingScore: Math.random() * 100
            };
        }

        function generateLineage() {
            const lineages = [
                ["BERT", "RoBERTa", "DeBERTa", "This Paper"],
                ["GPT-2", "GPT-3", "InstructGPT", "This Paper"],
                ["ResNet", "EfficientNet", "ConvNeXT", "This Paper"],
                ["Transformer", "Vision Transformer", "Swin Transformer", "This Paper"],
                ["GAN", "StyleGAN", "StyleGAN2", "This Paper"]
            ];
            return lineages[Math.floor(Math.random() * lineages.length)];
        }

        // Enhanced Paper Card Rendering
        function renderEnhancedPaperCard(paper) {
            const metrics = generateImpactMetrics();
            const lineage = generateLineage();
            const aiSummary = userProfile.preferences?.aiSummaries ? generateAISummary(paper.title, paper.abstract) : null;
            const whyItMatters = generateWhyItMatters(paper.title);
            
            const isSaved = savedPapers.some(p => p.title === paper.title);
            
            return `
                <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex-1">
                            <h3 class="text-xl font-semibold text-gray-900 mb-2">${paper.title}</h3>
                            <p class="text-sm text-gray-600 mb-2">${paper.authors}</p>
                            <div class="flex items-center gap-4 text-sm text-gray-500">
                                <span>${paper.year}</span>
                                <span>‚Ä¢</span>
                                <span>${paper.venue || 'Preprint'}</span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="toggleSave('${paper.title}')" class="p-2 hover:bg-gray-100 rounded-lg transition">
                                <i data-lucide="${isSaved ? 'bookmark' : 'bookmark-plus'}" class="w-5 h-5 ${isSaved ? 'text-purple-600' : 'text-gray-400'}"></i>
                            </button>
                            <button class="p-2 hover:bg-gray-100 rounded-lg transition">
                                <i data-lucide="share-2" class="w-5 h-5 text-gray-400"></i>
                            </button>
                        </div>
                    </div>
                    
                    ${aiSummary ? `
                        <div class="mb-4 p-4 bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg border border-purple-200">
                            <div class="flex items-center gap-2 mb-2">
                                <i data-lucide="sparkles" class="w-4 h-4 text-purple-600"></i>
                                <span class="font-semibold text-purple-700">AI SUMMARY</span>
                            </div>
                            <p class="text-gray-700">${aiSummary}</p>
                        </div>
                    ` : ''}
                    
                    <div class="mb-4 p-4 bg-blue-50 rounded-lg">
                        <div class="flex items-center gap-2 mb-2">
                            <i data-lucide="lightbulb" class="w-4 h-4 text-blue-600"></i>
                            <span class="font-semibold text-blue-700">Why This Matters:</span>
                        </div>
                        <p class="text-gray-700">${whyItMatters}</p>
                    </div>
                    
                    <!-- Impact Metrics -->
                    <div class="grid grid-cols-4 gap-3 mb-4">
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">${metrics.citations}</div>
                            <div class="text-xs text-gray-500 flex items-center justify-center gap-1">
                                <i data-lucide="quote" class="w-3 h-3"></i>
                                Citations
                            </div>
                        </div>
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">${metrics.github}</div>
                            <div class="text-xs text-gray-500 flex items-center justify-center gap-1">
                                <i data-lucide="github" class="w-3 h-3"></i>
                                GitHub
                            </div>
                        </div>
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">${metrics.blogs}</div>
                            <div class="text-xs text-gray-500 flex items-center justify-center gap-1">
                                <i data-lucide="edit-3" class="w-3 h-3"></i>
                                Blogs
                            </div>
                        </div>
                        <div class="text-center p-2 bg-gray-50 rounded-lg">
                            <div class="text-2xl font-bold text-gray-900">${metrics.inUse}</div>
                            <div class="text-xs text-gray-500 flex items-center justify-center gap-1">
                                <i data-lucide="package" class="w-3 h-3"></i>
                                In Use
                            </div>
                        </div>
                    </div>
                    
                    <!-- Research Lineage -->
                    <div class="mb-4 p-3 bg-gradient-to-r from-green-50 to-teal-50 rounded-lg">
                        <div class="flex items-center gap-2 mb-2">
                            <i data-lucide="git-branch" class="w-4 h-4 text-green-600"></i>
                            <span class="font-semibold text-green-700">RESEARCH LINEAGE</span>
                        </div>
                        <div class="flex items-center gap-2">
                            ${lineage.map((item, idx) => `
                                <span class="${idx === lineage.length - 1 ? 'font-semibold text-green-700' : 'text-gray-600'}">${item}</span>
                                ${idx < lineage.length - 1 ? '<span class="text-gray-400">‚Üí</span>' : ''}
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- Abstract -->
                    <p class="text-gray-700 mb-4 line-clamp-3">${paper.abstract}</p>
                    
                    <!-- Tags -->
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${paper.categories.map(cat => `
                            <span class="px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs">${cat}</span>
                        `).join('')}
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex items-center justify-between">
                        <div class="flex gap-3">
                            <a href="${paper.url}" target="_blank" class="text-purple-600 hover:text-purple-800 text-sm font-medium flex items-center gap-1">
                                <i data-lucide="external-link" class="w-4 h-4"></i>
                                View Paper
                            </a>
                            ${paper.pdfUrl ? `
                                <a href="${paper.pdfUrl}" target="_blank" class="text-green-600 hover:text-green-800 text-sm font-medium flex items-center gap-1">
                                    <i data-lucide="file-text" class="w-4 h-4"></i>
                                    PDF
                                </a>
                            ` : ''}
                            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1">
                                <i data-lucide="message-square" class="w-4 h-4"></i>
                                Discuss
                            </button>
                        </div>
                        <div class="flex items-center gap-2">
                            ${metrics.trendingScore > 70 ? '<span class="px-2 py-1 bg-red-100 text-red-700 rounded-full text-xs font-semibold">üî• Trending</span>' : ''}
                            ${metrics.citations > 500 ? '<span class="px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-semibold">‚≠ê High Impact</span>' : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // Sample Papers Data (would be fetched from API)
        function getSamplePapers() {
            return [
                {
                    title: "Scaling Laws for Neural Language Models",
                    authors: "Kaplan et al.",
                    year: "2020",
                    abstract: "We study empirical scaling laws for language model performance on the cross-entropy loss. The loss scales as a power-law with model size, dataset size, and the amount of compute used for training, with some trends spanning more than seven orders of magnitude.",
                    url: "https://arxiv.org/abs/2001.08361",
                    pdfUrl: "https://arxiv.org/pdf/2001.08361.pdf",
                    categories: ["NLP", "Deep Learning", "Scaling"],
                    venue: "NeurIPS 2020"
                },
                {
                    title: "Attention Is All You Need",
                    authors: "Vaswani et al.",
                    year: "2017",
                    abstract: "The dominant sequence transduction models are based on complex recurrent or convolutional neural networks in an encoder-decoder configuration. The best performing models also connect the encoder and decoder through an attention mechanism.",
                    url: "https://arxiv.org/abs/1706.03762",
                    pdfUrl: "https://arxiv.org/pdf/1706.03762.pdf",
                    categories: ["Transformers", "NLP", "Architecture"],
                    venue: "NeurIPS 2017"
                },
                {
                    title: "BERT: Pre-training of Deep Bidirectional Transformers",
                    authors: "Devlin et al.",
                    year: "2019",
                    abstract: "We introduce a new language representation model called BERT, which stands for Bidirectional Encoder Representations from Transformers. Unlike recent language representation models, BERT is designed to pre-train deep bidirectional representations.",
                    url: "https://arxiv.org/abs/1810.04805",
                    pdfUrl: "https://arxiv.org/pdf/1810.04805.pdf",
                    categories: ["NLP", "Pre-training", "Transformers"],
                    venue: "NAACL 2019"
                }
            ];
        }

        // Load Papers Functions
        async function loadPersonalizedPapers() {
            document.getElementById('loadingIndicator').classList.remove('hidden');
            document.getElementById('papersContainer').innerHTML = '';
            
            // Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            papers = getSamplePapers();
            
            // Filter based on user interests
            if (userProfile.interests?.length > 0) {
                // Simulate personalized ranking
                papers = papers.sort(() => Math.random() - 0.5);
            }
            
            renderPapers(papers);
            document.getElementById('loadingIndicator').classList.add('hidden');
        }

        function renderPapers(papersList) {
            const container = document.getElementById('papersContainer');
            container.innerHTML = papersList.map(paper => renderEnhancedPaperCard(paper)).join('');
            
            // Re-initialize Lucide icons for new elements
            lucide.createIcons();
            
            // Show/hide load more button
            document.getElementById('loadMoreContainer').classList.toggle('hidden', papersList.length < 3);
        }

        // Search Functions
        function searchPapers() {
            const query = document.getElementById('searchInput').value;
            console.log('Classic search for:', query);
            loadPersonalizedPapers(); // Simulate search
        }

        function searchWithAI() {
            const query = document.getElementById('searchInput').value;
            console.log('AI-powered search for:', query);
            
            // Show AI is working
            document.getElementById('loadingIndicator').querySelector('p').textContent = 'AI is analyzing your query...';
            loadPersonalizedPapers();
        }

        function searchByInterest(interest) {
            document.getElementById('searchInput').value = interest.replace('-', ' ');
            searchWithAI();
        }

        // Filter Functions
        function setFilter(filter) {
            currentFilter = filter;
            console.log('Filter set to:', filter);
            
            // Update UI to show active filter
            document.querySelectorAll('button[onclick^="setFilter"]').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-purple-500');
            });
            event.target.classList.add('ring-2', 'ring-purple-500');
            
            // Load papers based on filter
            switch(filter) {
                case 'for-you':
                    loadPersonalizedPapers();
                    break;
                case 'trending':
                    // Load trending papers
                    loadPersonalizedPapers();
                    break;
                case 'high-impact':
                    // Load high impact papers
                    loadPersonalizedPapers();
                    break;
                case 'needs-review':
                    // Load papers needing review
                    loadPersonalizedPapers();
                    break;
                case 'breakthrough':
                    // Load breakthrough papers
                    loadPersonalizedPapers();
                    break;
            }
        }

        // Save/Bookmark Functions
        function toggleSave(paperTitle) {
            const index = savedPapers.findIndex(p => p.title === paperTitle);
            if (index > -1) {
                savedPapers.splice(index, 1);
            } else {
                const paper = papers.find(p => p.title === paperTitle);
                if (paper) savedPapers.push(paper);
            }
            localStorage.setItem('savedPapers', JSON.stringify(savedPapers));
            
            // Re-render papers to update bookmark status
            renderPapers(papers);
        }

        function loadMore() {
            // Simulate loading more papers
            const morePapers = getSamplePapers();
            papers = [...papers, ...morePapers];
            renderPapers(papers);
        }

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark');
            // Would need to implement full dark mode styles
        }

        // Initialize on load
        window.addEventListener('load', () => {
            initializeUserProfile();
            loadPersonalizedPapers();
        });

        // Handle Enter key in search
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchWithAI();
            }
        });
    </script>
</body>
</html>